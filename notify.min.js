/*!
 *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 *  SOFTWARE.
 *
 * Date: 09/08/2015
 * @version 1.01
 * @author Angel Zaprianov <me@fire1.eu>
 * Homepage: https://github.com/fire1/Notify
 */
(function(a){a.notify=function(k){var b=a.extend({url:"",timer:1000,query:{},icon:"notify.png",data:[]},k);var c=function(l,m){return localStorage.setItem(l,JSON.stringify(m))};var f=function(l){return JSON.parse(localStorage.getItem(l))};var h=f("notifyTime");if(!h){h=[]}var j=function(m){if(!m.name||!m.body){console.error('Given file is not supported! Please set your json as {name: "", body:"", time:"" }');return}var l=parseInt(m.time);if(Math.floor(Date.now()/1000)<l){return}if(h.indexOf(l)==-1){h.push(l);d(m.name,m.body,!m.icon?b.icon:m.icon);c("notifyTime",h)}};var i=function(n,l,m){return new Notification(n,{body:l,icon:m})};var d=function(n,l,m){if(!("Notification" in window)){alert(l);console.error("Browser do not support notification!")}else{if(Notification.permission==="granted"){i(n,l,m)}else{if(Notification.permission!=="denied"){Notification.requestPermission(function(o){if(o==="granted"){i(n,l,m)}})}}}};var e=function(){a.each(b.data,function(l,m){j(m)});setTimeout(e,b.timer)};var g=function(){var l=a.ajax({url:b.url,data:b.query,dataType:"json"});l.done(function(m){a.each(m,function(n,o){j(o)})});l.fail(function(m,n){console.error("Cannot find given URL page: "+b.url)});setTimeout(g,b.timer)};if(b.url){g()}else{if(b.data.length>0){e()}else{console.error("Ajax URL is not set!")}}}}(jQuery));